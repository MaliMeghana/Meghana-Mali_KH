-- create database Assignment2;

----- TABLE CREATION ----- 
CREATE TABLE PUBLISHERS
(
    PUBID      int   PRIMARY KEY,
    PNAME      VARCHAR(30),
    EMAIL      VARCHAR(50)  UNIQUE,
    PHONE      VARCHAR(30)
);


CREATE TABLE  SUBJECTS
(
    SUBID      int PRIMARY KEY,
    SNAME      VARCHAR(30)
);


CREATE TABLE  AUTHORS
(
    AUID       int  PRIMARY KEY,
    ANAME      VARCHAR(30),
    EMAIL      VARCHAR(50)  UNIQUE,
    PHONE      VARCHAR(30)
);



CREATE TABLE  TITLES
(
    TITLEID    int PRIMARY KEY,
    TITLE      VARCHAR(30),
    PUBID      int,
    SUBID      int,
    PUBDATE    DATE,
    COVER      CHAR(1)  CHECK ( COVER IN ('P','H','p','h')),
    PRICE      int3,
	CONSTRAINT TITLES_PUBID_FK FOREIGN KEY (PUBID) REFERENCES PUBLISHERS(PUBID),
	CONSTRAINT TITLES_SUBID_FK FOREIGN KEY (SUBID) REFERENCES SUBJECTS(SUBID)
);



CREATE TABLE  TITLEAUTHORS
(
    TITLEID    int ,
    AUID       int ,
    IMPORTANCE int,
   PRIMARY KEY(TITLEID,AUID),
   CONSTRAINT  TITLESAUTHORS_TITLEID_FK FOREIGN KEY (TITLEID) REFERENCES TITLES(TITLEID),
   CONSTRAINT  TITLESAUTHORS_AUTHID_FK FOREIGN KEY (AUID) REFERENCES AUTHORS(AUID)
);

CREATE TABLE  SUBJECTS_BACKUP
(
    SUBID      int PRIMARY KEY,
    SNAME      VARCHAR(30)
);

select * from PUBLISHERS;
select * from SUBJECTS;
select * from AUTHORS;
select * from TITLES;
select * from TITLEAUTHORS;
select * from SUBJECTS_BACKUP;

-------- INSERT VALUES ----------------
INSERT INTO SUBJECTS VALUES (6,'C# .net'),
(2,'JAVA'),
(3,'JEE'),
(4,'VB'),
(5,'ASP');



INSERT INTO PUBLISHERS VALUES (1,'WILLEY','WDT@VSNL.NET','91-11-23260877'),
(2,'WROX','INFO@WROX.COM',NULL),
(3,'TATA MCGRAW-HILL','FEEDBACK@TATAMCGRAWHILL.COM','91-11-33333322'),
(4,'TECHMEDIA','BOOKS@TECHMEDIA.COM','91-11-33257660');



INSERT INTO AUTHORS VALUES (101, 'HERBERT SCHILD','HERBERT@YAHOO.COM',NULL),
 (102, 'JAMES GOODWILL','GOODWILL@HOTMAIL.COM',NULL),
 (103, 'DAVAID HUNTER','HUNTER@HOTMAIL.COM',NULL),
 (104, 'STEPHEN WALTHER','WALTHER@GMAIL.COM',NULL),
 (105, 'KEVIN LONEY','LONEY@ORACLE.COM',NULL),
(106, 'ED. ROMANS','ROMANS@THESERVERSIDE.COM',NULL);


INSERT INTO TITLES VALUES (1001,'ASP.NET UNLEASHED',4,5,'2002-04-12','P',540)
 ,(1002,'ORACLE10G COMP. REF.',3,1,'2005-05-01','P',575)
 ,(1003,'MASTERING EJB',1,3,'2005-02-03','P',475)
 ,(1004,'JAVA COMP. REF',3,2,'2005-04-03','P',499)
, (1005,'PRO. VB.NET',2,4,'2005-06-15','P',450);


INSERT INTO TITLEAUTHORS VALUES (1001,104,1),
(1002,105,1),
(1003,106,1),
(1004,101,1),
(1005,103,1),
(1005,102,2);

--------  1 QUERIES ------------
select * from PUBLISHERS;
select * from AUTHORS;
select * from TITLES;
select * from TITLEAUTHORS;

--------  2 QUERIES (LIKE) ------------
select sname from subjects where sname='ORACLE';
select sname from subjects where sname LIKE 'j%';
select sname from subjects where sname LIKE '%.net%';

select aname from authors where aname LIKE '%er';
select pname from publishers where pname LIKE '%hill%';

--------  3 QUERIES (RELATIONAL OPERATOR) ------------
SELECT TITLE FROM TITLES WHERE PRICE < 500;
SELECT TITLE FROM TITLES WHERE PUBDATE < '2005-04-03';
SELECT SNAME FROM SUBJECTS WHERE SUBID=2 OR SUBID=3;
SELECT ANAME FROM AUTHORS WHERE AUID > 103;
SELECT * FROM TITLES WHERE TITLEID=101 OR PRICE > 400;

--------  4 QUERIES (IN OPERATOR) ------------
SELECT * FROM PUBLISHERS WHERE PNAME IN('TECHMEDIA','WROX');

--------  5 QUERIES (AGGREGATE FUNCTION) ------------
SELECT MAX(PRICE) AS MAX_PRICE FROM TITLES;  
SELECT AVG(IMPORTANCE) AVG_IMPORTANCE FROM TITLEAUTHORS;
SELECT COUNT(AUID) AS NU_RECORDS FROM AUTHORS;
SELECT SUM(PRICE) AS SUM_BOOKS_PRICE FROM TITLES;

--------  6 QUERIES (DATE) ------------
SELECT TITLE FROM TITLES WHERE MONTH(PUBDATE)=4;
SELECT YEAR(CURDATE()) as YEAR;
SELECT MONTH(CURDATE()) as MONTH;
SELECT LAST_DAY(PUBDATE) from TITLES  where TITLE='JAVA COMP. REF';

--------  7 QUERIES (DML) ------------

CREATE TABLE EMPLOYEE (EMP_ID INT , EMP_NAME char);
INSERT INTO EMPLOYEE VALUES(1,'MEGHANA'),(2,'HARSHAL'),(3,'MEGHA');
ALTER TABLE EMPLOYEE ADD COLUMN DEPT_ID INT;
ALTER TABLE EMPLOYEE MODIFY COLUMN EMP_NAME varchar(20);
UPDATE EMPLOYEE SET EMP_NAME='Scott'; 
TRUNCATE TABLE EMPLOYEE;

--------  8 QUERIES (EMPLOYEE) ------------
SELECT * FROM EMPLOYEE;
ALTER  TABLE EMPLOYEE ADD COLUMN SALARY float(7,4);
INSERT INTO EMPLOYEE VALUES(1,'MEGHANA',3,123.567),(2,'HARSHAL',2,153.019),(3,'MEGHA',1,165.786),(4,'XYZ',2,177.156);

SELECT round(SALARY) AS SAL FROM EMPLOYEE;
-- SELECT truncate(SALARY) AS SAL FROM EMPLOYEE;
SELECT CEIL(SALARY) AS SAL FROM EMPLOYEE;
SELECT FLOOR(SALARY) AS SAL FROM EMPLOYEE;
SELECT SIGN(SALARY) AS SAL FROM EMPLOYEE;
SELECT mod(SALARY,2) AS HALF_SAL FROM EMPLOYEE;
SELECT SQRT(SALARY) AS SAL FROM EMPLOYEE;
SELECT POWER(SALARY) AS SAL FROM EMPLOYEE;

--------  8 QUERIES (STRING) ------------

SELECT length('Cdac Khargar') AS STR_LENGTH;
SELECT upper('Cdac Khargar') AS STR_LENGTH;
SELECT LOWER('Cdac Khargar') AS STR_LENGTH;

--------  8 QUERIES (STRING) ------------
SELECT current_date() AS DATE;
SELECT date_format(current_date(),'%d-%m-%y') as DATE;
SELECT date_format(current_date(),'%W-%D-%M-%Y') as DATE;
SELECT date_format(current_date(),'%W-%d-%b-%Y') as DATE;





